gandal=read.csv("modules_Gandal.csv")
mariani=read.csv("modules_mariani_ensembl.csv")
tylee=read.csv("modules_tylee_ensembl.csv")
voineagu=read.csv("modules_voineagu_ensembl.csv")
schafer=read.csv("modules_schafer.csv")
parikshak2013=read.csv("modules_Parikshak2013.csv")
parikshak2016=read.csv("modules_parikshak2016.csv")
derosa35=read.csv("modules_DeRosa35DIV.csv")
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA")
gupta=read.csv("modules_Gupta.csv")
gandal=read.csv("modules_Gandal.csv")
mariani=read.csv("modules_mariani_ensembl.csv")
tylee=read.csv("modules_tylee_ensembl.csv")
voineagu=read.csv("modules_voineagu_ensembl.csv")
schafer=read.csv("modules_schafer.csv")
parikshak2013=read.csv("modules_Parikshak2013.csv")
parikshak2016=read.csv("modules_parikshak2016.csv")
derosa35=read.csv("modules_DeRosa35DIV.csv")
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA")
gupta=read.csv("modules_Gupta.csv")
gandal=read.csv("modules_Gandal.csv")
mariani=read.csv("modules_mariani_ensembl.csv")
tylee=read.csv("modules_tylee_ensembl.csv")
voineagu=read.csv("modules_voineagu_ensembl.csv")
schafer=read.csv("modules_schafer.csv")
parikshak2013=read.csv("modules_Parikshak2013.csv")
parikshak2016=read.csv("modules_parikshak2016.csv")
derosa35=read.csv("modules_DeRosa35DIV.csv")
otherstudy2=left_join(schafer,modulesNPC, by="Ensembl")
View(otherstudy2)
View(otherstudy2)
yy=subset(otherstudy2, otherstudy2$Module=="saddlebrown_Schafer" & otherstudy2$moduleLabel=="M10")
enrichmenttab=read.csv("module_overlap_npc_allStudies_final.csv")
enrichmenttab=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/module_overlap_npc_allStudies_final.csv")
keep=enrichmenttab$moduleLabel=="M10"
View(enrichmenttab)
keep=enrichmenttab$InputCategories=="M10"
enrichmenttab=enrichmenttab[keep,]
View(enrichmenttab)
enrichmenttab=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/module_overlap_npc_allStudies_final.csv")
enrichmenttab=subset(enrichmenttab, enrichmenttab$InputCategories=="M10")
enrichmenttab$yesother.yesM10 = "NA"
enrichmenttab$yesother.nonM10 = "NA"
enrichmenttab$nonother.yesM10 = "NA"
enrichmenttab$nonother.nonM10 = "NA"
View(enrichmenttab)
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA")
gupta=read.csv("modules_Gupta.csv")
gandal=read.csv("modules_Gandal.csv")
mariani=read.csv("modules_mariani_ensembl.csv")
tylee=read.csv("modules_tylee_ensembl.csv")
voineagu=read.csv("modules_voineagu_ensembl.csv")
schafer=read.csv("modules_schafer.csv")
parikshak2013=read.csv("modules_Parikshak2013.csv")
parikshak2016=read.csv("modules_parikshak2016.csv")
derosa35=read.csv("modules_DeRosa35DIV.csv")
allStudies=rbind(gupta,gandal,mariani,tylee,voineagu,parikshak2013,parikshak2016,
derosa35)
allStudies=rbind(gupta,gandal,mariani,tylee,voineagu,schafer,parikshak2013,parikshak2016,
derosa35)
write.csv(allStudies, file="modules_allStudies.csv", row.names = FALSE)
NPCgenes= read.table ("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA/countData_RUV_Normalized_NPC_nDEGs_HKgenes_p0.3_k2.txt")
NPCgenes=as.data.frame(rownames(NPCgenes))
colnames(NPCgenes)="Ensembl"
NPCkme=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/kME_NPC_nDEGs_HKgene_p0.3_k2.csv")
modulesNPC=NPCkme[,c(1,3,4)]
modulesNPC=left_join(NPCgenes,modulesNPC)
modulesNPC[["moduleLabel"]][is.na(modulesNPC[["moduleLabel"]])] = "M0"
modulesNPC[["moduleColor"]][is.na(modulesNPC[["moduleColor"]])] = "grey"
write.table(modulesNPC,file="C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/genes_modules_NPC.txt", row.names=FALSE)
NPCgeneR=modulesNPC[,1]
NPClabelR=modulesNPC[,3]
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC")
userListEnrichment(
NPCgeneR, NPClabelR,
fnIn = ("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA/modules_allStudies.csv"),
nameOut = "module_overlap_npc_allStudies_final.csv",
omitCategories = c("M0","grey"), outputGenes = TRUE)
enrichmenttab=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/module_overlap_npc_allStudies_final.csv")
enrichmenttab=subset(enrichmenttab, enrichmenttab$InputCategories=="M10")
View(enrichmenttab)
enrichmenttab=enrichmenttab[c(1:8),]
enrichmenttab$yesother.yesM10 = "NA"
enrichmenttab$yesother.nonM10 = "NA"
enrichmenttab$nonother.yesM10 = "NA"
enrichmenttab$nonother.nonM10 = "NA"
otherstudy2=left_join(gupta,modulesNPC, by="Ensembl")
l=as.data.frame(yy,yn,ny.nn)
yy=subset(otherstudy2, otherstudy2$Module=="saddlebrown_Schafer" & otherstudy2$moduleLabel=="M10")
yn=subset(otherstudy2, otherstudy2$Module=="saddlebrown_Schafer" & !otherstudy2$moduleLabel=="M10")
ny=subset(otherstudy2, !otherstudy2$Module=="saddlebrown_Schafer" & otherstudy2$moduleLabel=="M10")
nn=subset(otherstudy2, !otherstudy2$Module=="saddlebrown_Schafer" & !otherstudy2$moduleLabel=="M10")
l=as.data.frame(yy,yn,ny.nn)
l=as.vector(yy,yn,ny.nn)
l=as.vector(yy,yn,ny,nn)
yy=subset(otherstudy2, otherstudy2$Module=="mod4_Gupta" & otherstudy2$moduleLabel=="M10")
yn=subset(otherstudy2, otherstudy2$Module=="mod4_Gupta" & !otherstudy2$moduleLabel=="M10")
ny=subset(otherstudy2, !otherstudy2$Module=="mod4_Gupta" & otherstudy2$moduleLabel=="M10")
nn=subset(otherstudy2, !otherstudy2$Module=="mod4_Gupta" & !otherstudy2$moduleLabel=="M10")
l
l=as.vector(yy,yn,ny,nn)
l=as.matrix(yy,yn,ny,nn)
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA")
NPCdata=read.table("countdata_20M_NPC.txt")
View(NPCdata)
nn=as.numeric(subset(otherstudy2, !otherstudy2$Module=="mod4_Gupta" & !otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="mod4_Gupta" & !otherstudy2$moduleLabel=="M10"))
View(nn)
yy=count(subset(otherstudy2, otherstudy2$Module=="mod4_Gupta" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="mod4_Gupta" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="mod4_Gupta" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="mod4_Gupta" & !otherstudy2$moduleLabel=="M10"))
l=as.vector(yy,yn,ny,nn)
l=as.data.frame(yy,yn,ny,nn)
View(l)
l=as.data.frame(c(yy,yn,ny,nn))
View(l)
View(nn)
View(ny)
View(otherstudy2)
View(enrichmenttab)
View(l)
View(yy)
enrichmenttab[1,7]=l[1,1]
enrichmenttab[1:]=l[1:]
enrichmenttab[1,c(7:10)]=l[1,c(1:4)]
View(enrichmenttab)
otherstudy2=left_join(parikshak2013,modulesNPC, by="Ensembl")
yy=subset(otherstudy2, otherstudy2$Module=="M14_Parikshak2013" & otherstudy2$moduleLabel=="M10")
yn=subset(otherstudy2, otherstudy2$Module=="M14_Parikshak2013" & !otherstudy2$moduleLabel=="M10")
ny=subset(otherstudy2, !otherstudy2$Module=="M14_Parikshak2013" & otherstudy2$moduleLabel=="M10")
nn=subset(otherstudy2, !otherstudy2$Module=="M14_Parikshak2013" & !otherstudy2$moduleLabel=="M10")
l=as.data.frame(c(yy,yn,ny,nn))
otherstudy2=left_join(parikshak2013,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="M14_Parikshak2013" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="M14_Parikshak2013" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="M14_Parikshak2013" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="M14_Parikshak2013" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[2,c(7:10)]=l[2,c(1:4)]
otherstudy2=left_join(parikshak2016,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="21_Parikshak2016" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="21_Parikshak2016" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="21_Parikshak2016" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="21_Parikshak2016" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[3,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(parikshak2013,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="M14_Parikshak2013" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="M14_Parikshak2013" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="M14_Parikshak2013" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="M14_Parikshak2013" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
View(l)
enrichmenttab[2,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(voineagu,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="9_Voineagu" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="9_Voineagu" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="9_Voineagu" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="9_Voineagu" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
View(l)
enrichmenttab[4,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(tylee,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="midnightblue_Tylee" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="midnightblue_Tylee" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="midnightblue_Tylee" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="midnightblue_Tylee" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[5,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="brown_Tylee" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="brown_Tylee" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="brown_Tylee" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="brown_Tylee" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[6,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(schafer,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="saddlebrown_Schafer" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="saddlebrown_Schafer" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="saddlebrown_Schafer" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="saddlebrown_Schafer" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[7,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(voineagu,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="2_Voineagu" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="2_Voineagu" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="2_Voineagu" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="2_Voineagu" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[8,c(7:10)]=l[1,c(1:4)]
View(yy)
View(voineagu)
View(allStudies)
write.table(enrichmenttab,file="C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/module_overlap_npc_allStudies_final.csv")
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA")
gupta=read.csv("modules_Gupta.csv")
gandal=read.csv("modules_Gandal.csv")
mariani=read.csv("modules_mariani_ensembl.csv")
tylee=read.csv("modules_tylee_ensembl.csv")
voineagu=read.csv("modules_voineagu_ensembl.csv")
schafer=read.csv("modules_schafer.csv")
parikshak2013=read.csv("modules_Parikshak2013.csv")
parikshak2016=read.csv("modules_parikshak2016.csv")
derosa35=read.csv("modules_DeRosa35DIV.csv")
allStudies=rbind(gupta,gandal,mariani,tylee,voineagu,schafer,parikshak2013,parikshak2016,
derosa35)
write.csv(allStudies, file="modules_allStudies.csv", row.names = FALSE)
NPCgenes= read.table ("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA/countData_RUV_Normalized_NPC_nDEGs_HKgenes_p0.3_k2.txt")
NPCgenes=as.data.frame(rownames(NPCgenes))
colnames(NPCgenes)="Ensembl"
NPCkme=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/kME_NPC_nDEGs_HKgene_p0.3_k2.csv")
modulesNPC=NPCkme[,c(1,3,4)]
modulesNPC=left_join(NPCgenes,modulesNPC)
modulesNPC[["moduleLabel"]][is.na(modulesNPC[["moduleLabel"]])] = "M0"
modulesNPC[["moduleColor"]][is.na(modulesNPC[["moduleColor"]])] = "grey"
write.table(modulesNPC,file="C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/genes_modules_NPC.txt", row.names=FALSE)
NPCgeneR=modulesNPC[,1]
NPClabelR=modulesNPC[,3]
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC")
userListEnrichment(
NPCgeneR, NPClabelR,
fnIn = ("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA/modules_allStudies.csv"),
nameOut = "module_overlap_npc_allStudies_final.csv",
omitCategories = c("M0","grey"), outputGenes = TRUE)
enrichmenttab=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/module_overlap_npc_allStudies_final.csv")
enrichmenttab=subset(enrichmenttab, enrichmenttab$InputCategories=="M10")
#omit last row that overlaps with "grey_mariani"
enrichmenttab=enrichmenttab[c(1:8),]
enrichmenttab$yesother.yesM10 = "NA"
enrichmenttab$yesother.nonM10 = "NA"
enrichmenttab$nonother.yesM10 = "NA"
enrichmenttab$nonother.nonM10 = "NA"
View(enrichmenttab)
otherstudy2=left_join(voineagu,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="2_Voineagu" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="2_Voineagu" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="2_Voineagu" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="2_Voineagu" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[8,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="9_Voineagu" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="9_Voineagu" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="9_Voineagu" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="9_Voineagu" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[4,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(gupta,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="mod4_Gupta" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="mod4_Gupta" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="mod4_Gupta" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="mod4_Gupta" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[1,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(parikshak2013,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="M14_Parikshak2013" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="M14_Parikshak2013" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="M14_Parikshak2013" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="M14_Parikshak2013" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[2,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(parikshak2016,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="21_Parikshak2016" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="21_Parikshak2016" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="21_Parikshak2016" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="21_Parikshak2016" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[3,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(tylee,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="midnightblue_Tylee" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="midnightblue_Tylee" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="midnightblue_Tylee" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="midnightblue_Tylee" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[5,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="brown_Tylee" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="brown_Tylee" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="brown_Tylee" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="brown_Tylee" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[6,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(schafer,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="saddlebrown_Schafer" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="saddlebrown_Schafer" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="saddlebrown_Schafer" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="saddlebrown_Schafer" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[7,c(7:10)]=l[1,c(1:4)]
write.table(enrichmenttab,file="C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/NPC/module_overlap_npc_allStudies_final_M10.csv")
enrichmenttab$oddsratio = "NA"
for(j in c(1:nrow(enrichmenttab)))
{counts = (matrix(data = as.numeric(as.character(enrichmenttab[j,c(8,9,10,11)])), nrow=2))
res = fisher.test(counts)
enrichmenttab$oddsratio[j]=res$estimate}
enrichmenttab=enrichmenttab[,c(1:4,12,5:11)]
for(j in c(1:nrow(enrichmenttab)))
{counts = (matrix(data = as.numeric(as.character(enrichmenttab[j,c(7,8,9,10)])), nrow=2))
res = fisher.test(counts)
enrichmenttab$oddsratio[j]=res$estimate}
enrichmenttab=enrichmenttab[,c(1:4,12,5:11)]
enrichmenttab=enrichmenttab[,c(1,2,4,11,7:10,6)]
write.csv(enrichmenttab, file="module_overlap_npc_allStudies_M10_final.csv")
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA")
Neuronkme=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neuron/kME_Neuron_nDEGs_HKgene_p0.4_k4.csv")
Neuronkme=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons/kME_Neuron_nDEGs_HKgene_p0.4_k4.csv")
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons")
Neuronkme=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons/kME_Neuron_nDEGs_HKgenes_p0.4_k4.csv")
Neurongenes= read.table ("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA/countData_RUV_Normalized_Neurons_nDEGs_HKgenes_p0.4_k4.txt")
Neurongenes=as.data.frame(rownames(Neurongenes))
colnames(Neurongenes)="Ensembl"
Neuronkme=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons/kME_Neuron_nDEGs_HKgenes_p0.4_k4.csv")
modulesNeuron=Neuronkme[,c(1,3,4)]
modulesNeuron=left_join(Neurongenes,modulesNeuron)
modulesNeuron[["moduleLabel"]][is.na(modulesNeuron[["moduleLabel"]])] = "M0"
modulesNeuron[["moduleColor"]][is.na(modulesNeuron[["moduleColor"]])] = "grey"
write.table(modulesNeuron,file="C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons/genes_modules_Neurons.txt", row.names=FALSE)
NeurongeneR=modulesNeuron[,1]
NeuronlabelR=modulesNeuron[,3]
setwd("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons")
userListEnrichment(
NeurongeneR, NeuronlabelR,
fnIn = ("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/DATA/modules_allStudies.csv"),
nameOut = "module_overlap_neuron_allStudies_final.csv",
omitCategories = c("M0","grey"), outputGenes = TRUE)
enrichmenttab=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons/module_overlap_neurons_allStudies_final.csv")
enrichmenttab=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons/module_overlap_neuron_allStudies_final.csv")
enrichmenttab=subset(enrichmenttab, enrichmenttab$InputCategories=="M1")
View(enrichmenttab)
enrichmenttab=read.csv("C:/Users/karin/Dropbox/Arquivos_genomica_autistas/RNAseq/RNAseq_files/Resultados_finais/RESULTS/Neurons/module_overlap_neuron_allStudies_final.csv")
enrichmenttab=subset(enrichmenttab, enrichmenttab$InputCategories=="M1"|enrichmenttab$InputCategories=="M18")
View(enrichmenttab)
enrichmenttab$yesother.yesM10 = "NA"
enrichmenttab$yesother.nonM10 = "NA"
enrichmenttab$nonother.yesM10 = "NA"
enrichmenttab$nonother.nonM10 = "NA"
otherstudy2=left_join(schafer,modulesNPC, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="lightyellow_Schafer" & otherstudy2$moduleLabel=="M10"))
yn=count(subset(otherstudy2, otherstudy2$Module=="lightyellow_Schafer" & !otherstudy2$moduleLabel=="M10"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="lightyellow_Schafer" & otherstudy2$moduleLabel=="M10"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="lightyellow_Schafer" & !otherstudy2$moduleLabel=="M10"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[1,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(schafer,modulesNeuron, by="Ensembl")
View(otherstudy2)
yy=count(subset(otherstudy2, otherstudy2$Module=="lightyellow_Schafer" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="lightyellow_Schafer" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="lightyellow_Schafer" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="lightyellow_Schafer" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[1,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(mariani,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="brown_Mariani" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="brown_Mariani" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="brown_Mariani" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="brown_Mariani" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[2,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="pink_Mariani" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="pink_Mariani" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="pink_Mariani" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="pink_Mariani" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[14,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="tan_Mariani" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="tan_Mariani" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="tan_Mariani" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="tan_Mariani" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[19,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="blue_Mariani" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="blue_Mariani" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="blue_Mariani" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="blue_Mariani" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[23,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(gupta,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="mod1_Gupta" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="mod1_Gupta" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="mod1_Gupta" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="mod1_Gupta" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[3,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="mod2_Gupta" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="mod2_Gupta" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="mod2_Gupta" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="mod2_Gupta" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[7,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="mod6_Gupta" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="mod6_Gupta" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="mod6_Gupta" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="mod6_Gupta" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[18,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(gandal,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="CD1_Gandal" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="CD1_Gandal" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="CD1_Gandal" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="CD1_Gandal" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[4,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="CD13_Gandal" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="CD13_Gandal" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="CD13_Gandal" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="CD13_Gandal" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[20,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(parikshak2013,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="M17_Parikshak2013" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="M17_Parikshak2013" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="M17_Parikshak2013" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="M17_Parikshak2013" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[5,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="M16_Parikshak2013" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="M16_Parikshak2013" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="M16_Parikshak2013" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="M16_Parikshak2013" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[9,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="M13_Parikshak2013" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="M13_Parikshak2013" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="M13_Parikshak2013" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="M13_Parikshak2013" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[11,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(derosa35,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="M19_DeRosa35" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="M19_DeRosa35" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="M19_DeRosa35" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="M19_DeRosa35" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[6,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(voineagu,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="12_Voineagu" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="12_Voineagu" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="12_Voineagu" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="12_Voineagu" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[8,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="8_Voineagu" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="8_Voineagu" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="8_Voineagu" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="8_Voineagu" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[15,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(tylee,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="grey_Tylee" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="grey_Tylee" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="grey_Tylee" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="grey_Tylee" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[10,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(parikshak2016,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="25_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="25_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="25_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="25_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[12,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="16_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="16_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="16_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="16_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[13,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="17_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="17_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="17_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="17_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[16,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="10_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="10_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="10_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="10_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[24,c(7:10)]=l[1,c(1:4)]
yy=count(subset(otherstudy2, otherstudy2$Module=="4_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
yn=count(subset(otherstudy2, otherstudy2$Module=="4_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="4_Parikshak2016" & otherstudy2$moduleLabel=="M1"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="4_Parikshak2016" & !otherstudy2$moduleLabel=="M1"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[25,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(schafer,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="brown4_Schafer" & otherstudy2$moduleLabel=="M18"))
yn=count(subset(otherstudy2, otherstudy2$Module=="brown4_Schafer" & !otherstudy2$moduleLabel=="M18"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="brown4_Schafer" & otherstudy2$moduleLabel=="M18"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="brown4_Schafer" & !otherstudy2$moduleLabel=="M18"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[21,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(mariani,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="red_Mariani" & otherstudy2$moduleLabel=="M18"))
yn=count(subset(otherstudy2, otherstudy2$Module=="red_Mariani" & !otherstudy2$moduleLabel=="M18"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="red_Mariani" & otherstudy2$moduleLabel=="M18"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="red_Mariani" & !otherstudy2$moduleLabel=="M18"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[22,c(7:10)]=l[1,c(1:4)]
otherstudy2=left_join(parikshak2013,modulesNeuron, by="Ensembl")
yy=count(subset(otherstudy2, otherstudy2$Module=="M3_Parikshak2013" & otherstudy2$moduleLabel=="M18"))
yn=count(subset(otherstudy2, otherstudy2$Module=="M3_Parikshak2013" & !otherstudy2$moduleLabel=="M18"))
ny=count(subset(otherstudy2, !otherstudy2$Module=="M3_Parikshak2013" & otherstudy2$moduleLabel=="M18"))
nn=count(subset(otherstudy2, !otherstudy2$Module=="M3_Parikshak2013" & !otherstudy2$moduleLabel=="M18"))
l=as.data.frame(c(yy,yn,ny,nn))
enrichmenttab[17,c(7:10)]=l[1,c(1:4)]
enrichmenttab$oddsratio = "NA"
for(j in c(1:nrow(enrichmenttab)))
{counts = (matrix(data = as.numeric(as.character(enrichmenttab[j,c(7,8,9,10)])), nrow=2))
res = fisher.test(counts)
enrichmenttab$oddsratio[j]=res$estimate}
enrichmenttab=enrichmenttab[,c(1,2,4,11,7:10,6)]
getwd()
write.csv(enrichmenttab, file="module_overlap_neuron_allStudies_M1_M18_final.csv")
